<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YouTube Proxy Player</title>
<style>
  html, body {
    margin: 0;
    height: 100%;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #player-container {
    width: 100%;
    height: 100%;
    max-width: 800px;
    aspect-ratio: 16/9;
    position: relative;
    background: #000;
  }

  #player {
    width: 100%;
    height: 100%;
  }

  /* Overlay trasparente per bloccare Share */
  #overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: transparent;
    z-index: 10;
    cursor: pointer; /* opzionale */
  }

  /* Controlli personalizzati */
  #controls {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 10px 20px;
    display: flex;
    align-items: center;
    gap: 10px;
    background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
    z-index: 20;
  }

  .btn {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    border: none;
    background: rgba(255,255,255,0.2);
    color: white;
    cursor: pointer;
  }

  .btn:hover {
    background: rgba(255,255,255,0.3);
  }

  #progress-container {
    flex: 1;
    height: 6px;
    background: rgba(255,255,255,0.2);
    border-radius: 3px;
    cursor: pointer;
    position: relative;
  }

  #progress-bar {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #8b5cf6, #3b82f6);
    border-radius: 3px;
  }
</style>
</head>
<body>

<div id="player-container">
  <div id="player"></div>
  <div id="overlay"></div>

  <!-- Controlli -->
  <div id="controls">
    <button class="btn" id="play-pause">▶️</button>
    <div id="progress-container">
      <div id="progress-bar"></div>
    </div>
  </div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
  // Prende ID video dalla query string ?v=
  const params = new URLSearchParams(window.location.search);
  const videoId = params.get('v') || 'JUiH2nspbgQ';

  let player;
  let isPlaying = false;
  let progressInterval;

  function onYouTubeIframeAPIReady() {
    player = new YT.Player('player', {
      videoId: videoId,
      playerVars: {
        controls: 0,
        modestbranding: 1,
        rel: 0,
        showinfo: 0
      },
      events: {
        onReady: onPlayerReady,
        onStateChange: onPlayerStateChange
      }
    });
  }

  function onPlayerReady() {
    updateProgress();
  }

  function onPlayerStateChange(event) {
    if(event.data === YT.PlayerState.PLAYING){
      isPlaying = true;
      startProgress();
    } else {
      isPlaying = false;
      stopProgress();
    }
  }

  function startProgress() {
    progressInterval = setInterval(updateProgress, 200);
  }

  function stopProgress() {
    clearInterval(progressInterval);
  }

  function updateProgress() {
    if(!player) return;
    const duration = player.getDuration() || 0;
    const current = player.getCurrentTime() || 0;
    const percent = (current / duration) * 100;
    document.getElementById('progress-bar').style.width = percent + '%';
  }

  // Play/pause button
  document.getElementById('play-pause').addEventListener('click', () => {
    if(!player) return;
    if(isPlaying){
      player.pauseVideo();
    } else {
      player.playVideo();
    }
  });

  // Overlay click (può anche fare play/pause)
  document.getElementById('overlay').addEventListener('click', () => {
    if(!player) return;
    if(isPlaying){
      player.pauseVideo();
    } else {
      player.playVideo();
    }
  });

  // Progress bar click
  document.getElementById('progress-container').addEventListener('click', (e)=>{
    const rect = e.currentTarget.getBoundingClientRect();
    const percent = (e.clientX - rect.left) / rect.width;
    if(player) player.seekTo(player.getDuration() * percent);
  });
</script>

</body>
</html>
